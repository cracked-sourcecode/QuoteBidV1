QuoteBid â€‘ Pitchâ€‘Stage Sync & UI Overhaul
Developer Brief for Replit Workspace

1. Core Objective
Guarantee that a single sourceâ€‘ofâ€‘truth â€œstageâ€ for every pitch is persisted in Postgres, served by the API, and reflected in all client views (Opportunities card, Pitch Detail modal, Myâ€¯Pitches list, and Admin Portal). From the moment a user creates a pitch until coverage is secured, the interface must always display the correct wording, buttons, and actions for that stage.

2. Canonical Stage Model
Enum (pitches.status)	Admin dropdown label	Customerâ€‘facing label	Customer actions allowed
draft	Draft	Draft â€“ finish & submit	Edit â€¢ Submit
pending	Pending	Pitch Pending	Edit
sent_to_reporter	Pitchâ€¯Sent	Pitch Sent	View only
reporter_interested	Reporter Interested	Reporter Interested	View reporter notes (future)
reporter_not_interested	Reporter Not Interested	Reporter Declined	Archive
successful_coverage	Successful Coverage	Coverage Secured	View article â€¢ Invoice

Add a NOT NULL enum column with the above values and migrate existing rows.
Status updates occur only in two places:

Customer app sets draftâ€¯â†’â€¯pending (submit action).

Admin Portal sets any further transitions via dropdown.

3. Database & API
Foreign keys:

pitches.publication_id â†’ publications.id (no more â€œUnknown Publicationâ€).

pitches.opportunity_id â†’ opportunities.id.

Default joins: /api/pitches must include opportunity title, publication name, and current status.

Realâ€‘time updates: Emit a pitchStatusUpdated WebSocket (or Serverâ€‘Sent Events) so the customer UI refreshes instantly when an admin changes the status.

4. Frontâ€‘End Requirements
4.1 Opportunities Card
If user already has a pitch on an opportunity, replace Place Your Bid panel with a compact status banner:

â€œYou bid $X â€“ Status: Pitch Pending (click to view/edit)â€.

4.2 Pitch Detail Modal (opened from Opportunities or Myâ€¯Pitches)
Title becomes â€œPitch Statusâ€.

Stageâ€‘based component map:

Stage	Header Icon	Body Copy	Buttons
pending	ğŸ“	â€œYour pitch has been submitted and is awaiting internal review. You may still edit it until we begin outreach.â€	Edit Pitch â€¢ Browse Other Opportunities
sent_to_reporter	ğŸš€	â€œWeâ€™ve sent your pitch to the reporter. Sit tightâ€”weâ€™ll keep you posted.â€	â€”
reporter_interested	â­	â€œGreat news! The reporter wants more info. Weâ€™ll follow up shortly.â€	â€”
reporter_not_interested	âŒ	â€œThis reporter passed on the pitch. Keep an eye on new opportunities.â€	Browse Other Opportunities
successful_coverage	âœ…	â€œCoverage secured! View the live article below.â€	View Article

4.3 Myâ€¯Pitches Page
Each card displays: publication logo, opportunity title, status badge (colorâ€‘coded), and vertical progress tracker (five dots matching the enum).

Drafts show a blue â€œFinish your pitchâ€ banner.

Clicking the card opens the Pitch Status modal above.

4.4 Disable Redundant Actions
Once a pitch exists (any status other than draft), hide/disable â€œBidâ€ button for that opportunity.

Only pending pitches expose Edit Pitch.

5. Admin Portal Updates
Dropdown options should map exactly to the enum keys.

Changing a status fires the WebSocket event.

Optional: add a â€œSend to reporterâ€ quickâ€‘action button that sets sent_to_reporter.

6. Acceptance Criteria
Submitting a pitch always creates pitches.status = 'pending', emits event, and UI shifts to Pitch Pending state without reload.

Admin toggling status updates UI for an alreadyâ€‘open customer session within 3â€¯s.

â€œUnknownâ€¯Publicationâ€ never appearsâ€”publication names propagate endâ€‘toâ€‘end.

Attempting a second bid on the same opportunity surfaces the status banner instead of the bid form.

Unit tests: status transitions, API joins, and WebSocket event payloads.

Cypress e2e: draftâ€¯â†’â€¯pendingâ€¯â†’â€¯sent_to_reporter path reflected in UI at each step.

7. Suggested Task Breakdown
DB Migration â€“ add enum, foreign keys, seed status values.

API Layer â€“ extend pitches endpoints, add WebSocket.

Admin UX â€“ enforce enum mapping, emit events.

Customer React Components â€“ refactor OpportunitiesCard, PitchModal, MyPitchesList to consume unified status prop.

Realâ€‘time Hook â€“ subscribe to pitchStatusUpdated.

QA & Regression Tests.

Deliver this spec verbatim to the Replit team; it contains the exact schema changes, API contracts, UI copy, and success metrics they need to implement the fully agentic, stageâ€‘aware flow.